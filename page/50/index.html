<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Dong&#39;s blog</title>
  <meta property="og:title" content="Dong&#39;s blog" />
  <meta name="twitter:title" content="Dong&#39;s blog" />
  <meta name="description" content="Front Page Content beautifulhugo supports content on your front page. Edit /content/_index.md to change what appears here. Delete /content/_index.md if you don&rsquo;t want any content here.">
  <meta property="og:description" content="Front Page Content beautifulhugo supports content on your front page. Edit /content/_index.md to change what appears here. Delete /content/_index.md if you don&rsquo;t want any content here.">
  <meta name="twitter:description" content="Front Page Content beautifulhugo supports content on your front page. Edit /content/_index.md to change what appears here. Delete /content/_index.md if you don&rsquo;t want any content here.">
  <meta name="author" content="Leiming Dong"/>
  <link href='../../img/red-paint.jpg' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="/img/red-paint.jpg" />
  <meta name="twitter:image" content="/img/red-paint.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@username" />
  <meta name="twitter:creator" content="@username" />
  <meta property="og:url" content="/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Dong&#39;s blog" />

  <meta name="generator" content="Hugo 0.31.1" />
  <link rel="canonical" href="../../" />
  <link rel="alternate" href="../../index.xml" type="application/rss+xml" title="Dong&#39;s blog">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="../../css/codeblock.css" />
  <link rel="stylesheet" href="../../css/highlight.min.css" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../">Dong&#39;s blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="../../">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Samples</a>
              <div class="navlinks-children">
                
                  <a href="../../post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="../../post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="../../post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="../../page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="../../tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Dong&#39;s blog" href="../../">
            <img class="avatar-img" src="../../img/red-paint.jpg" alt="Dong&#39;s blog" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>Dong&#39;s blog</h1>
                
                  
                    <hr class="small">
                    <span class="page-subheading">Enterprising &amp; Concentrating欢迎光临！</span>
                  
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
  <div role="main" class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
          <div class="well">
            

<h2 id="front-page-content">Front Page Content</h2>

<p><code>beautifulhugo</code> supports content on your front page. Edit <code>/content/_index.md</code> to change what appears here. Delete <code>/content/_index.md</code> if you don&rsquo;t want any content here.</p>

          </div>
        

        <div class="posts-list">
          
          
            <article class="post-preview">
              <a href="../../post/%E9%9A%8F%E7%AC%94/%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%AD%BE%E5%90%8D--%E5%92%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%8C%87%E7%BA%B9%E7%B1%BB%E4%BC%BC/">
                <h2 class="post-title">基因组签名--和基因组指纹类似</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (19 words)
  
  
</span>


              <div class="post-entry">
                
                  <blockquote>
<p>Kariin S, Burge C. 1995. Dinucleotide relative abundance extremes: a genomic signature. Trends in Genetics, 11(7): 283–290.
二核苷酸相对丰度极值：基因组签名</p>
</blockquote>

<p>早期生物化学实验证实，二核苷酸优势比或“一般设计”的集合是生物体的DNA的显着稳定的性质，其在蛋白质编码的DNA，本体基因组DNA中以及不同的复性速率和密度基本相同许多生物体中基因组DNA的梯度分数。目前可获得的基因组序列数据的分析已经扩展了这些较早的结果，表明基因组的不相交样品的一般设计与其他生物体的序列基本上更相似，并且密切相关的生物具有相似的一般设计。从这个角度来看，二核苷酸优势比（相对丰度）值的组合构成了每个DNA基因组的标记，其可以区分来自不同生物体的序列。二核苷酸比值比值似乎不仅反映了二核苷酸堆积能的化学成分和碱基阶段构象偏好，而且反映了DNA修饰，复制和修复机制的物种特异性。</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/bayesian/%E5%A4%9A%E5%8F%98%E9%87%8F%E9%98%88%E5%80%BC-%E5%88%86%E5%AD%90%E9%81%97%E4%BC%A0%E6%95%B0%E6%8D%AE-gibbs/">
                <h2 class="post-title">多变量阈值-分子遗传数据-Gibbs</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (71 words)
  
  
</span>


              <div class="post-entry">
                
                  Stock KF, Distl O, Hoeschele I. Bayesian estimation of genetic parameters for multivariate threshold and continuous phenotypes and molecular genetic data in simulated horse populations using Gibbs sampling. BMC Genet. [Internet]. 2007;8:19. Available from: http://dx.doi.org/10.1186/1471-2156-8-19   使用Gibbs采样的模拟马群中多变量阈值和连续表型和分子遗传数据的遗传参数的贝叶斯估计
抽象
背景 成功实施包括表型和基因型信息的多变量动物阈值模型的要求尚不清楚。这里使用模拟马数据来调查遗传参数的遗传参数的多变量估计器的性质在分类，连续和分子遗传数据在重要的放射性健康性状的背景下使用混合线性阈值动物模型通过Gibbs采样。模拟谱系包括7代和40000动物每代。模拟了四个二元性状的一个连续性状和负债liabilities的加性遗传值，残差​​和固定效应，类似于Warmblood马中遇到的情况。对一种负债模拟了数量性状基因座（QTL）效应和遗传标记信息。研究了遗传标记与QTL之间的重组率和遗传标记多态性信息含量的不同情况。对于每种情况，从模拟群体中抽取10个重复，并且在每个重复中产生具有性状记录和遗传标志信息可用性的动物的数量和分布不同的6个不同数据集。 （Co）方差分量使用​​贝叶斯混合线性阈值动物模型通过Gibbs采样进行估计。残差方差固定为零，适当的先验用于遗传协方差矩阵。
结果 有效样本大小（ESS）和遗传参数的偏差在数据集之间显着不同。遗传力估计的偏差对于连续性状为-6％至+ 6％，对于中度遗传性的二元性状为-6％至+ 10％，对于低遗传力的二元性状为-21％至+ 25％。加性遗传相关性大多低估了低遗传力的连续性状和二元性状之间，在连续性状和中度遗传性的二元性状之间低估或高估，并且在两个二元性状之间高估。使用性状信息对后续两代动物增加了ESS和减少参数估计的偏差，而不仅仅是增加来自一代的信息性动物的数量。将基因型信息考虑为模型中的固定效应导致高估QTL性状的多基因遗传性，但增加QTL性状的加性遗传相关性的准确性**。
结论 联合使用表型和基因型信息对父母和后代将有助于确定感兴趣的性状之间的激动和拮抗遗传相关性，促进有效的多特征选择方案的设计。
背景
使用线性模型估计分类性状的遗传参数违反了混合线性模型方法的基本假设。已经开发了算法以将线性模型估计转换为潜在的责任尺度，以补偿由线性模型中的非线性性状的分析所导致的估计偏差，但是变换的遗传参数估计可能仍然是显着偏差的[例如， 2，3，4]]。阈值模型用于估计遗传参数的使用直接说明了分类性状的非线性性质，并且阈值模型估计应当比线性模型估计或变换的线性模型估计更可靠[例如[5,6,7]]。
马尔科夫链蒙特卡罗（MCMC）方法如吉布斯取样（GS）使得实现多变量阈值模型或多变量混合线性阈值模型成为可能。动物模型充分利用可用的谱系信息，但遗传方差和协方差估计的准确性以及GS链的收敛可能在低性状流行率和每个个体的少量观察的情况下是一个问题[例如[5,8,9,10] ]。因此，在实际情况下，多变量动物阈值模型的实现并不总是直接的。连续性状的包含，即使用多元线性阈值模型，预期增加遗传参数估计的可靠性[例如，[2,11,12,13]]。
在动物育种中，健康数据通常使用离散类别记录，而大多数性能特征是连续的。在马中，二进制编码已经用于对马on的放射学检查的研究，并且在年轻马的肢体中已经确定了放射学可见的改变的高流行性，主要在10-25％的范围内。 [14，15，16，17]]。这促进了寻求预防而不是治疗措施。由于马运动系统的强度和健壮性在马业的所有部门都非常重要，因此已经提出在Warmblood骑乘马的当前育种计划中包括放射健康性状[18,19]。这些分类性状的可靠估计的遗传参数提供了这样做的基础。对于分析的射线照相健康数据，根据Dempster和Lerner [20]和Vinson等人的转换因子的适用性[21]通过残差最大似然（REML）获得的线性动物模型估计已经通过模拟证明[22]。然而，由线性模型中的二元性状的分析引起的并且必须通过变换进行补偿的过估计或低估速率取决于数据结构。因此，需要重新评估变换过程，以分析关于可用信息的分布和种类的不同结构的数据。用于（共）方差分量估计的贝叶斯多变量动物阈值或混合线性阈值模型的实现可以提供有价值的替代方案。
已经为不同物种的生产和健康性状鉴定了定量性状基因座（QTL），即包括影响个体关于特定性状的表型的基因的基因组区域[23]。增加对遗传决定放射性健康特性的知识[24,25]意味着在马中改进遗传评价和选择计划的进一步机会。有效利用标记辅助选择的条件已经被描述[26]，但是结合使用表型和基因型数据对分类性状的遗传参数估计的准确性的影响还没有被研究。成功实施包括表型和基因型信息的多变量动物阈值模型的要求是未知的。
本研究的目的是使用线性阈值动物模型和Gibbs采样来表征分类，连续和分子遗传数据的遗传参数的多变量估计的性质。在Warmblood马的重要放射健康性状的上下文中研究了数据结构和分子遗传数据的质量对遗传参数估计的准确性的影响。
统计分析 使用用于动物模型的多特征Gibbs采样器（MTGSAM）的阈值版本的Gibbs采样来评估遗传参数[35]，该软件支持连续和分类性状的任何组合的多变量遗传分析。随机和残差效应被假定为正态分布，平均先验被用于固定效应。用户可以为加性遗传和残差（共）方差矩阵指定起始值和先验。对于我们的分析，为所有加性遗传变异选择起始值1，对所有加性遗传协方差选择起始值0，并且所有性状之间的残余协方差固定为零。在单变量和多变量二进制阈值模型中，通过将阈值和残差方差分别固定为零和一的值来确保模型的可识别性[36]。用于限制固定在一个的对角线元素的残余协方差矩阵的有效抽样的方法仍在开发中。然而，本研究的残差协方差的固定由以前的实际数据分析的结果证明[14]，并拟合我们的模拟数据。因为残差协方差在实际数据中可以忽略，因此在数据模拟中设置为零，进一步信息的可能增益似乎与残差协方差的采样的额外成本不成比例。因此，在本研究中，残余协方差被固定为零。对于遗传协方差矩阵，使用具有最小形状参数（即υIW= 7）的逆Wishart分布的适当的先验，以确保后验适当性。在所有分析中考虑了性别和当代组的固定效应。在仅对数据集C1和C2的分析中考虑标记基因型的固定效应，区分所有遗传标记的不利等位基因纯合阴性的个体，至少一个遗传标记的不利等位基因杂合的个体和纯合的个体对于四种遗传标记中的至少一种的不利等位基因。
在所有分析中，吉布斯链的总长度设定为205000，并且保存5000轮的老化后的所有样品。通过样品图的目视检查来检查Gibbs链的收缩以及对要丢弃的加性轮次的老化的需要。通过在后Gibbs分析程序POSTGIBBSF90 [37]中实施的时间序列方法，以10的稀释率计算所有（共）方差估计值的有效样本大小（ESS）和蒙特卡罗误差（MCE）。未稀释的链用于计算加性遗传（共）方差，遗传性和加性遗传相关性估计的后验均值。选择后验手段而不是模式作为点估计，因为在初步分析中，手段在大多数情况下比模式更接近于真实的，即模拟的值，这与先前的研究一致[8,38]。遗传性和加性遗传相关性估计的偏差计算为估计值（parest）与真实（即模拟）值（partrue）的平均相对偏差。
bias =（par est-par true）/ par true
                  <a href="../../post/bayesian/%E5%A4%9A%E5%8F%98%E9%87%8F%E9%98%88%E5%80%BC-%E5%88%86%E5%AD%90%E9%81%97%E4%BC%A0%E6%95%B0%E6%8D%AE-gibbs/" class="post-read-more">[Read More]</a>
                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/">
                <h2 class="post-title">如何计算效应值（例如育种值）的准确性（accuracy）？</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (78 words)
  
  
</span>


              <div class="post-entry">
                
                  准确性指的是预测效应值与真值之间的相关系数。有时还会遇见一个概念——可靠性（reliability）。可靠性是准确性的平方，也就是说这二者度量的是一个事情。reliability其实就是遗传力，这句很重要！！！。遗传力主要用来计算选择响应（response to selection）。advisor说我的文章短句子太多，不连贯，确实是这样LOL。 准确性的计算公式为：
$$r=\sqrt{1-\frac{PEV}{\hat{\sigma}_a^2}}$$
_PEV_是prediction error variances的缩写，意思是预测误差方差，预测误差是预测值与真值间的差，即：
$$PEV=var(\hat g-g)=(1-r_{\hat g,g}^2)\sigma_a^2$$
$\sigma_a^2$是加性方差。
预测差值的标准误（_SED_）是可以从Asreml中直接得到的，与_PEV_的关系是：
$$SED=\sqrt{\hat Var(BLUP.differences)}=\sqrt{\hat Var(\hat Yi-\hat Y{i^ \prime})}=\sqrt{2\hat Var(\hat Y)_i}=\sqrt{2PEV}$$
我不知道上面这个公式怎么推导的。 所以有
$$PEV=(SED)^{2}/2=\hat Var(BLUP.differences)/2$$
在很长时间里我不知道（或者说模糊地知道）accuracy是怎么实现的。我知道公式，但在软件里分别和公式组分对应的部分是什么却不是很清楚，当然写这篇文字的时候是确定的。具体实现的途径有2：
 一是利用Asreml中的prediction直接得到_SED_后，再根据公式4得出PEV
fm_pred &lt;- predict(fm_asr, classify = &quot;Fam&quot;) #fm_asr是asreml()输出的对象， Fam是随机效应变量 SED &lt;- fm_pred$predictions$avsed  二是逐步得到_PEV_，每个预测值都有一个_PEV_，是预测值_SE_平方的均值，所以从预测函数得到的对象中提取出_SE_平方后再平均即可
fm_pred &lt;- predict(fm_asr, classify = &quot;Fam&quot;, present = &quot;Plot&quot;) #注意！这里预测的时候是要矫正掉其他的随机效应（如Plot） SE &lt;- fm_pred$predictions$pvals$standard.error PEV &lt;- SE^2 %&gt;% mean  这里的_PEV_是一个向量，对应到每个水平上。 所以，总体上，_PEV_、_SED_和_SE_的关系是 $$PEV=(SED)^{2}/2=ave(SE_i^2)$$
  另外，在林元震老师的著作R与ASReml-R统计学中（P474）也涉及到accuracy的代码
SE &lt;- fm_asr$vcoeff$random _ fm_asr$sigma2 #效应值se乘以sigma  结果是一样的，但不知道是否合理。
                  <a href="../../post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/" class="post-read-more">[Read More]</a>
                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E9%9A%8F%E7%AC%94/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7accuracy/">
                <h2 class="post-title">如何计算效应值（例如育种值）的准确性（accuracy）？</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (61 words)
  
  
</span>


              <div class="post-entry">
                
                  <p><strong>准确性</strong>指的是_预测效应值与真值之间的相关系数_。有时还会遇见一个概念——<strong>可靠性</strong>（reliability）。可靠性是准确性的平方，也就是说这二者度量的是一个事情。<strong>reliability其实就是遗传力，这句很重要！！！</strong>。遗传力主要用来计算选择响应（response to selection）。advisor说我的文章<strong>短</strong>句子太多，不连贯，确实是这样LOL。
准确性的计算公式为：
<img src="http://upload-images.jianshu.io/upload_images/3289684-df01d4346d0a920c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式1-accuracy.png" />
*PEV*是prediction error variances的缩写，意思是预测误差方差，预测误差是预测值与真值间的差，即：
<img src="http://upload-images.jianshu.io/upload_images/3289684-71c421143dcb27a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式2-pev.png" />
<code>简书不支持公式真是淡疼！</code>
*\sigma a^2*是加性方差。</p>

<p>预测差值的标准误（*SED*）是可以从<code>Asreml</code>中直接得到的，与*PEV*的关系是：
<img src="http://upload-images.jianshu.io/upload_images/3289684-203b10837faa6399.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式3-sed.png" />
<code>我不知道上面这个公式怎么推导的。</code>
所以有
<img src="http://upload-images.jianshu.io/upload_images/3289684-1d6b8186eae7255a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式4-pev2.png" /></p>

<hr />

<p>在很长时间里我不知道（或者说模糊地知道）accuracy是怎么实现的。我知道公式，但在软件里分别和公式组分对应的部分是什么却不是很清楚，当然写这篇文字的时候是确定的。具体实现的途径有2：
- 一是利用Asreml中的<code>prediction</code>直接得到*SED*后，再根据公式4得出PEV</p>

<pre><code>fm_pred &lt;- predict(fm_asr, classify = &quot;Fam&quot;) #fm_asr是asreml()输出的对象， Fam是随机效应变量
SED &lt;- fm_pred$predictions$avsed
</code></pre>

<ul>
<li>二是逐步得到*PEV*，每个预测值都有一个*PEV*，是预测值*SE*平方的均值，所以从预测函数得到的对象中提取出*SE*平方后再平均即可
<code>
fm_pred &lt;- predict(fm_asr, classify = &quot;Fam&quot;, present = &quot;Plot&quot;) #注意！这里预测的时候是要矫正掉其他的随机效应（如Plot）
SE &lt;- fm_pred$predictions$pvals$standard.error
PEV &lt;-  SE^2 %&gt;% mean
</code>
这里的*PEV*是一个向量，对应到每个水平上。
所以，总体上，*PEV*、*SED*和*SE*的关系是
<img src="http://upload-images.jianshu.io/upload_images/3289684-085e91a277591ca0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式5-pev4.png" /></li>
</ul>

<p>另外，在林元震老师的著作<strong>R与ASReml-R统计学</strong>中（P474）也涉及到accuracy的代码</p>

<pre><code>SE &lt;- fm_asr$vcoeff$random * fm_asr$sigma2 #效应值se乘以sigma
</code></pre>

<p>结果是一样的，但不知道是否合理。</p>

<hr />

<p>如果没有Asreml可能需要更底层的计算（比如手动），这时*PEV*的计算更直观些：<img src="http://upload-images.jianshu.io/upload_images/3289684-6aed173dad4f5946.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式6-pev3.png" />
于是有<img src="http://upload-images.jianshu.io/upload_images/3289684-c9c67b6d1bffe6a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="公式7-reliability.png" />
*C^{22}*是方程组关联矩阵的逆矩阵的右下角块，*d_i*是块中的对角线元素。具体可查看<a href="https://pan.baidu.com/s/1hrDRLeG">Pro. Isik编写的教材P84</a>和<a href="https://pan.baidu.com/s/1nvmT47n">Mrode, 2014的书P44</a>。</p>

<p>从*PEV*就可以得到我们需要的准确性和可靠性值了。</p>

<hr />

<p>这个问题在群中还被讨论过
<img src="http://upload-images.jianshu.io/upload_images/3289684-9908dc53ac300bbc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="accuracy_chat.jpg" /></p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E9%9A%8F%E7%AC%94/%E5%A6%82%E6%9E%9C%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%9C%89nn%E4%B8%BA%E5%A4%A7%E4%BA%8E%E6%88%96%E7%AD%89%E4%BA%8E3%E7%9A%84%E6%95%B4%E6%95%B0%E4%B8%AA%E7%82%B9%E4%B8%94%E6%AF%8F3%E4%B8%AA%E7%82%B9%E5%9D%87%E4%B8%8D%E5%9C%A8%E5%90%8C%E4%B8%80%E6%9D%A1%E7%9B%B4%E7%BA%BF%E4%B8%8A%E9%82%A3%E4%B9%88%E6%9C%80%E5%A4%9A%E5%8F%AF%E4%BB%A5%E7%94%BB_________%E6%9D%A1%E7%9B%B4%E7%BA%BF%E7%94%A8%E5%90%ABn%E7%9A%84%E5%BC%8F%E5%AD%90%E8%A1%A8%E7%A4%BA/">
                <h2 class="post-title">如果平面上有n(n为大于或等于3的整数)个点，且每3个点均不在同一条直线上，那么最多可以画_________条直线(用含n的式子表示)</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (6 words)
  
  
</span>


              <div class="post-entry">
                
                  <blockquote>
<p>如果平面上有n(n为大于或等于3的整数)个点，且每3个点均不在同一条直线上，那么最多可以画_________条直线(用含n的式子表示)？</p>
</blockquote>

<p>　第一感觉是画图，画图直观些，容易发现规律，于是有：<img src="http://upload-images.jianshu.io/upload_images/3289684-b9ad0da82458c77a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
　但很难发现这2组数间的规律，所以这种方法对于多数初中生（包括我，数列学得不好）是找不出二者的关系式的。
　请教Jane，她直接告诉了我答案（牛人就是牛）：n(n-1)/2。我告诉她我需要推导过程，她给我整排列组合，也不是很好理解。
　当我看到这个答案时，我恍惚在哪里见过：
<img src="http://upload-images.jianshu.io/upload_images/3289684-60f2a7d50c40adee.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="双列" /></p>

<p>所以，这种题的背后的问题是：<strong>n个点，两两组合，一共有多少种组合？</strong>没有限制条件的话应该是*n^2*（n方）个（看上面那个图），但自己和自己的组合要去掉（*n*个，不用怀疑，对角线部分），剩余*n^2-n<em>个；因为正向和反向组合算是重复，还要再去掉一半，只剩对角线上（或下）的部分，所以答案是</em>(n^2-n)/2*。
我想对于一个初中生而言，这种题目比较难，大部分人会死记这个答案，对于某些老师来说也未必能讲清楚。我觉得<strong>列矩阵（列表）的方法应该是最容易理解的</strong>，供参考。</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E9%9A%8F%E7%AC%94/%E5%AE%89%E8%A3%85arb/">
                <h2 class="post-title">安装ARB</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (174 words)
  
  
</span>


              <div class="post-entry">
                
                  下载ARB wget http://download.arb-home.de/build/latest/arb-6.0.6.ubuntu1404-amd64.tgz tar -xzvf arb-6.0.6.ubuntu1404-amd64.tgz
 安装一些ARB需要的库 sudo apt-get install xfig libmotif4 libpng3 xloadimage gv libglew1.5 gnuplot  正在读取软件包列表... 完成 正在分析软件包的依赖关系树 正在读取状态信息... 完成 注意，根据正则表达式 'libglew1.5' 选中了 'libglew1.5-dev' 注意，选中 'libglew-dev' 而非 'libglew1.5-dev' 没有可用的软件包 libmotif4，但是它被其它的软件包引用了。 这可能意味着这个缺失的软件包可能已被废弃， 或者只能在其他发布源中找到 然而下列软件包会取代它： libxm4:i386 libuil4:i386 libmrm4:i386 libxm4 libuil4 libmrm4 libmotif-common E: 软件包 libmotif4 没有可安装候选
 修改环境变量 sudo vim /etc/bash.bashrc （vim需要安装，如果没有安装，用gedit也可以）
  软件包设置 ┌──────────────────────────┤ 正在设定 arb-common ├──────────────────────────┐ │ The default configuration of PT-server slots in /etc/arb/arb_tcp.
                  <a href="../../post/%E9%9A%8F%E7%AC%94/%E5%AE%89%E8%A3%85arb/" class="post-read-more">[Read More]</a>
                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E6%8A%95%E7%A8%BF%E6%8A%80%E5%B7%A7/%E5%BB%B6%E6%9C%9F%E7%94%B3%E8%AF%B7/">
                <h2 class="post-title">延期申请</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 2 minutes (257 words)
  
  
</span>


              <div class="post-entry">
                
                  Dear Editor,
We appreciate that you gave us a chance of major revision to improve our manuscript (NEFO-D-17-00012) to a level suitable for publication in your journal. I am afraid we can not finish the revision before the deadline (Dec 12) because some questions that the reviewers gave us had not been carefully considered before and have taken us a lot of time. Therefore I write this Email to request an extension of two weeks (Dec 26).
                  <a href="../../post/%E6%8A%95%E7%A8%BF%E6%8A%80%E5%B7%A7/%E5%BB%B6%E6%9C%9F%E7%94%B3%E8%AF%B7/" class="post-read-more">[Read More]</a>
                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/rcodes/%E6%8A%93%E5%8F%96%E4%B8%80%E4%BA%9B%E7%BD%91%E9%A1%B5%E7%9A%84%E4%BF%A1%E6%81%AF/">
                <h2 class="post-title">抓取一些网页的信息</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (14 words)
  
  
</span>


              <div class="post-entry">
                
                  <pre><code>web&lt;-readLines(&quot;https://edu.hellobi.com/course/explore?page=1&quot;,encoding = 'UTF-8')
class&lt;-web[grep(&quot;class=\&quot;caption\&quot;&quot;,web)+3]
class
class&lt;-gsub(&quot;&quot;,&quot;&quot;,class)
class
length&lt;-web[grep(&quot;class=\&quot;length\&quot;&quot;,web)]
length
length&lt;-substr(length,regexpr(&quot;i&gt;&quot;,length)+2,regexpr(&quot;课&quot;,length)-1)
length
result&lt;-data.frame(课程=class,课时数=length)
DT::datatable(df)
install.packages(&quot;DT&quot;)
</code></pre>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E8%AE%BA%E6%96%87/%E6%8A%95%E7%A8%BF/">
                <h2 class="post-title">投稿</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 10 minutes (2013 words)
  
  
</span>


              <div class="post-entry">
                
                  New forests larch_rif@163.com larix9685
the Forestry Industry Research Special Funds for Public Welfare Projects(201504104)
Additional Information is Required for Submission. Please respond to the questions/statements below.
 Have you submitted this manuscript elsewhere? NO.   The authors declare that:  The submitted work has not been published before (neither in English or any other language) and that the work is not under consideration for publication elsewhere.
All data presented in the manuscript represent original research by the authors.
                  <a href="../../post/%E8%AE%BA%E6%96%87/%E6%8A%95%E7%A8%BF/" class="post-read-more">[Read More]</a>
                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="../../post/%E9%9A%8F%E7%AC%94/%E6%8C%89%E8%AF%8D%E6%80%A7%E6%8F%90%E5%8F%96%E5%8D%95%E8%AF%8D/">
                <h2 class="post-title">按词性提取单词</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 1, 2017
  
  
  &nbsp;|&nbsp;
  <i class="fa fa-clock-o"></i> 1 minutes (11 words)
  
  
</span>


              <div class="post-entry">
                
                  <blockquote>
<p>一直关注这样一个问题，一段英文文字中用到了哪些词，尤其是动名形容词？这样可以有目的地提高词汇量从而有助于英文写作。</p>
</blockquote>

<p>几乎每届<code>R</code>语言会议上都有关于文本处理的分会场，文本处理在如今的社会中有非常重要的应用。但是对于自己而言并不需要这些繁杂的用处，而且英文的处理相对于中文要简单不少，在R中也有相应的包可以实现这些。一开始借助<a href="https://stackoverflow.com/questions/30995232/how-to-use-opennlp-to-get-pos-tags-in-r"><strong>OpenNLP</strong></a>，但有几个缺点：
- 2个包要用到rjava，安装时非常之繁琐且容易失败，<a href="http://www.jianshu.com/writer#/notebooks/7124595/notes/12988009">解决方法</a>。</p>

<ul>
<li><p>分词很慢。</p></li>

<li><p>同一个单词不同词形比如复数、时态不能归一，造成冗余。</p></li>
</ul>

<p>后来为了解决词形的问题时遇到<a href="http://www.cnblogs.com/pinard/p/6756534.html">一页博客</a>提及对应的英文单词是<strong>lemmatization</strong>，通过google后找到<a href="https://stackoverflow.com/questions/28214148/how-to-perform-lemmatization-in-r">koRpus</a>利用<a href="http://www.cis.uni-muenchen.de/~schmid/tools/TreeTagger/">TreeTagger</a>能够实现。注意Windows下要下载<a href="http://www.cis.uni-muenchen.de/~schmid/tools/TreeTagger/data/english-par-linux-3.2-utf8.bin.gz">English parameter file</a>并解压到lib文件夹中，以及安装<a href="https://www.activestate.com/activeperl/downloads">Perl</a>。运行时可能会报错，koRpus的解决方法见<a href="https://github.com/unDocUMeantIt/koRpus/issues/7">这里</a>。
分词（或句子）用<code>quanteda::tokenize</code>实现。</p>

<p>提取的结果并不完美，例如会出现数字开头的错误单词，不要苛责。</p>

                
              </div>

              
            </article>
          
        </div>

        
          <ul class="pager main-pager">
            
              <li class="previous">
                <a href="../../page/49/">&larr; Newer Posts</a>
              </li>
            
            
              <li class="next">
                <a href="../../page/51/">Older Posts &rarr;</a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:youremail@domain.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/username" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://plus.google.com/&#43;username" title="Google&#43;">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/username" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://gitlab.com/username" title="GitLab">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-gitlab fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/username" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://reddit.com/u/username" title="Reddit">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-reddit-alien fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/username" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.xing.com/profile/username" title="Xing">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-xing fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/XXXXXXX/username" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.snapchat.com/add/username" title="Snapchat">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-snapchat-ghost fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/username" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/user/username" title="Youtube">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://soundcloud.com/username" title="SoundCloud">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-soundcloud fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://open.spotify.com/user/username" title="Spotify">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-spotify fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://username.bandcamp.com/" title="Bandcamp">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-bandcamp fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://itch.io/profile/username" title="Itch.io">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-gamepad fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://vk.com/username" title="VK">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-vk fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://paypal.me/username" title="PayPal">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-paypal fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://telegram.me/username" title="Telegram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-telegram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="../../index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="yourwebsite.com">Leiming Dong</a>
            
          

          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="../../">Dong&#39;s blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.31.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../js/main.js"></script>
<script src="../../js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="../../js/load-photoswipe.js"></script>






  </body>
</html>

