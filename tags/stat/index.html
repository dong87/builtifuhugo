<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Stat</title>
  <meta property="og:title" content="Stat" />
  <meta name="twitter:title" content="Stat" />
  <meta name="author" content="Leiming Dong"/>
  <link href='../../img/red-paint.jpg' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="/img/red-paint.jpg" />
  <meta name="twitter:image" content="/img/red-paint.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@username" />
  <meta name="twitter:creator" content="@username" />
  <meta property="og:url" content="/tags/stat/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Dong&#39;s blog" />

  <meta name="generator" content="Hugo 0.31.1" />
  <link rel="canonical" href="../../tags/stat/" />
  <link rel="alternate" href="../../tags/stat/index.xml" type="application/rss+xml" title="Dong&#39;s blog">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="../../css/codeblock.css" />
  <link rel="stylesheet" href="../../css/highlight.min.css" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../">Dong&#39;s blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="../../">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Samples</a>
              <div class="navlinks-children">
                
                  <a href="../../post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="../../post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="../../post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="../../page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="../../tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Dong&#39;s blog" href="../../">
            <img class="avatar-img" src="../../img/red-paint.jpg" alt="Dong&#39;s blog" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  <header class="header-section ">
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>#Stat</h1>
              <hr class="small">
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

    
  <div class="container" role="main">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <div class="posts-list">
          
            <article class="post-preview">
              <a href="../../post/stat/aic%E6%98%AF%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%A0%87%E5%87%86%E5%90%97/">
                <h2 class="post-title">AIC是正确的标准吗？</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  Is AIC the right criterion?  For small data and frequentist inference, you should use AICc &ndash; the small sample correction which provides greater penalty for each parameter but approaches AIC as *n* becomes large. If it makes a difference, you should use it. (I probably should have used it above.) For large data and frequentist inference , consider BIC, which is asymptotically consistent while AIC is not (see Hastie *et al.
                  <a href="../../post/stat/aic%E6%98%AF%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%A0%87%E5%87%86%E5%90%97/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/data-analysis-for-the-life-sciences-with-r/">
                <h2 class="post-title">Data-Analysis-for-the-Life-Sciences-with-R</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <p>##介绍
在20世纪下半叶，数字技术的前所未有的进步产生了一个转变科学的衡量革命。在生命科学中，数据分析现在是几乎每个研究项目的一部分。基因组学，特别是，正在由新的测量技术驱动，使我们第一次观察某些分子实体。这些观察结果导致类似于鉴定微生物和本发明显微镜允许的其它突破的发现。这些技术的选择实例是微阵列和下一代测序。传统上依赖于简单数据分析技术的科学领域已经被这些技术所吸引。在过去，例如，研究人员将测量感兴趣的单个基因的转录水平。今天，可以一次测量所有20,000+个人类基因。诸如这些的进步已经导致从假设向发现驱动的研究的转变。然而，解释从这些大量和复杂数据集提取的信息需要复杂的统计技能，因为人们可能容易被偶然发生的模式所愚弄。这大大提高了生命科学中统计和数据分析的重要性。
###谁会发现这本书有用？
这本书是由许多生命科学研究人员写的，他们正在成为数据分析师，因为对上述数据的依赖性增加。如果您正在执行自己的分析，您可能已计算p值，应用Bonferroni更正，执行主成分分析，制作热图或使用下一节中列出的一种或多种技术。如果你不太明白这些技术实际上是做什么，或者如果你不确定你是否正确使用它们，这本书是适合你的。
虽然本书的内容主要集中在高级统计概念，我们从覆盖基础知识开始，以确保所有读者都对所有数据分析所需的基本统计概念有很强的依据。<strong>我发现许多入门统计课程的教学方式很难将概念与数据分析联系起来。我们的方法确保你学习实践和理论之间的联系。</strong>因此，前两章，推理和探索性数据分析适用于介绍性的本科统计或数据科学课程。在这两个章节之后，统计复杂性的水平相对较快地上升。
<strong>虽然这本书的典型读者将有硕士或博士学位，我们努力保持数学内容在本科入门级。你不需要微积分来使用这本书。然而，我们引入和使用被认为比微积分更先进的线性代数。通过在数据分析的上下文中解释线性代数，我们相信你将能够学习基础知识而不知道微积分。更难的部分可能习惯符号和代号。</strong>更多关于这一点下面。
###这本书封面是什么？
本书将涵盖数据驱动生命科学研究成功所需的几个统计概念和数据分析技能。我们从与计算p值相关的相对基本概念到与分析高通量数据相关的高级主题。
我们从统计学和生命科学中最重要的主题之一开始：<strong>统计推断。推断是使用概率从数据中学习群体特征。</strong>一个典型的例子是解密两组（例如，病例与对照组）平均值不同。所涉及的具体主题包括<strong>t检验，置信区间，关联检验，蒙特卡罗方法，置换检验和统计功效</strong>。我们利用通过数学理论可能的近似，例如中心极限定理，以及通过现代计算可能的技术。我们将学习如何计算p值和置信区间，并实施基本的数据分析。在整本书中，我们将描述统计计算机语言R中用于探索新数据集的可视化技术。例如，我们将使用这些来学习何时应用稳健的统计技术。
然后我们将介绍线性模型和矩阵代数。<strong>我们将解释为什么使用线性模型来分析组之间的差异是有益的，以及为什么矩阵可用于表示和实现线性模型</strong>。我们继续回顾矩阵代数，包括矩阵符号和如何乘以矩阵（在纸上和在R中）。<strong>然后我们将应用我们涵盖的矩阵代数到线性模型。我们将学习如何在R中拟合线性模型，如何测试差异的显着性，以及如何估计差异的标准误差。</strong>此外，我们将回顾一些拟合线性模型的实际问题，包括共线性和混杂。最后，我们将学习如何拟合复杂模型，包括交互项，如何对比R中的多个项，以及R中的函数实际用于稳定拟合线性模型的强大技术：QR分解。
在本书的第三部分，我们涵盖了与高维数据相关的主题。具体来说，我们描述了多个测试，错误率控制程序，高吞吐量数据的探索性数据分析，p值校正和错误发现率。从这里我们继续覆盖统计建模。特别地，我们将讨论参数分布，包括二项式和伽马分布。接下来，我们将讨论最大似然估计。最后，我们将讨论层次模型和经验贝叶斯技术，以及它们如何应用于基因组学。
然后我们涵盖距离和尺寸缩减的概念。我们将介绍距离的数学定义，并使用它来激励用于维数缩减和多维缩放的奇异值分解（SVD）。一旦我们学到这一点，我们将准备好覆盖层次和k均值聚类。我们将跟踪这一点与机器学习的基本介绍。
我们通过学习批量效应以及如何使用组件和因素分析来应对这一挑战。特别是，我们将研究混杂，显示批次效应的例子，使因子分析的连接，并描述替代变量分析。
###这本书有什么不同？
虽然统计教科书侧重于数学，本书着重于使用计算机进行数据分析。这本书遵循Stat Labs1的方法，Deborah Nolan和Terry Speed。而不是解释数学和理论，然后展示例子，我们开始说明一个实际的数据相关的挑战。本书还包括提供问题解决方案并帮助说明解决方案背后的概念的计算机代码。通过自己运行代码，并且看到数据生成和分析发生在现场，你将得到一个更好的直觉的概念，数学和理论。
我们专注于数据分析师在生命科学领域面临的实际挑战，并引入数学作为一种工具，可以帮助我们实现科学目标。此外，在整本书中，我们展示了执行这种分析的R代码，并将代码行连接到我们解释的统计和数学概念。</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/genome-wide-association-studies-and-genomic-prediction/">
                <h2 class="post-title">Genome-Wide-Association-Studies-and-Genomic-Prediction</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  

<h1 id="第三章">第三章</h1>

<h2 id="1-1-frequentist-measures-of-evidence">1.1 Frequentist Measures of Evidence</h2>

<p>频率或非贝叶斯统计学家将概率视为限制重复事件的频率。 频繁者将认为未知参数具有真实值（仅仅，而不是概率分布），并且基于在假设重复样本下的统计的频率分布进行推断。频率统计学家不喜欢在贝叶斯统计中使用的先验概率分布的主观性。 然而，大多数实践的频率统计学家事实上对未知参数（例如，混合模型中的随机效应）使用先验概率分布，并且使用先验信息（例如，如果他们对于在接受之前需要较低阈值的效果更加怀疑 ）。 频率工作者使用p值，定义为测试统计量在假设复制下在零假设下比观测值更极端的概率</p>

<h2 id="1-2-bayesian-measures-of-evidence">1.2 Bayesian Measures of Evidence</h2>

<p>贝叶斯统计是基于概率理论的统计学[17]。概率理论是在不确定性下作出决策的唯一可靠的方法。尽管使用了几个世纪，但没有更好的方法被证明。概率模型（其中通常所有信息都是“先验”信息）被广泛使用（例如，在人工智能领域）。贝叶斯统计可以被认为是概率建模的一种特殊情况，其中除了先前的信息之外，还可以获得与生成数据的过程的模型一起的数据。贝叶斯统计学家使用概率理论来建模不确定性。贝叶斯定理用于将由概率分布表示的先验信息与生成数据的过程的数据和模型相结合，由似然函数表示。
注意：概率论的贝叶斯概念通常被认为与基于限制重复事件的概率的频率概率论不同。然而，概率论基本上是唯一的 - 这两种理论都满足概率理论的基本公理，因此基本上是相同的。如果无限重复事件序列可用，贝叶斯概率具有相同的限制频率解释。频率论者否认可以为先验信息构建概率模型，同时使用概率模型来确定可能性，其选择通常具有更宽的效应。贝叶斯方法的一个有力的论据是，在实践中，重复事件是假设的并且在实践中不可用，并且只有观察到的数据可用和相关。在统计学中，我们给出观测数据y，并且有兴趣了解未知参数θ。给定关于由概率分布πðθ表示的θ的先验知识和定义所观察数据的概率分布的似然函数fΘyjθ，贝叶斯定理给出了后验分布gðθj的表达式。贝叶斯定理[17]从条件概率的基本属性：对于任何事件A，B：</p>

<h1 id="2-power-calculations">2 Power Calculations</h1>

<h2 id="2-1-traditional-power-calculations-power">2.1 Traditional Power Calculations Power</h2>

<p><strong>POWER</strong>是用所使用的标准检测指定效应的概率。 传统的power计算得出用p≤α检测一个效应的概率，对于给定的效果大小。
*F*检验
考虑一个ANOVA模型，对于被测试的效应具有v1自由度，以及对于误差具有v2自由度。 在零假设下，F统计量具有（中心）F分布。 在替代假设下，F统计量具有非中心F分布。</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/hierarchical-nested-and-factorial/">
                <h2 class="post-title">Hierarchical-（Nested）-and-Factorial</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  

<h2 id="hierarchical-and-factorial-models">Hierarchical and Factorial models</h2>

<p>In globulus, the <strong>family</strong> (mum) is *nested* within the <strong>provenance</strong> (gg)</p>

<p>This is a matter of codification:</p>

<pre><code>Nested factors （Hierarchical models）
gg	mum
A	1
A	2
B	3
B	4

Crossed factors （Factorial models）
gg	mum
A	1
A	2
B	1
B	2
</code></pre>

<blockquote>
<p>分层（hierarchical）与巢式（nested）意思是一致的；cross与析因（factorial）是一致的。</p>
</blockquote>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s1--%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E7%9A%84%E6%96%B9%E6%B3%95/">
                <h2 class="post-title">S1--方差分析的方法</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  Venkateswarlu K., 1997 Estimation of Variance Components Based on a Diallel Model Involving Maternal and Maternal Interaction Effects. Biometrical J. 39: 287–295.
 There are several methods available in the literature for the estimation of variance components. These are: 1. Analysis of Variance (ANOVA), 2. Maximum Likelihood (ML) (HARTLEY and RAO, 1967), 3. Restricted Maximum Likelihood (REML) (PATTERSON and THOMPSON, 1971; CORBEIL and SEARLE, 1976), 4. Minimum Norm Quadratic Unbiased Estimation (MINQUE) (RAo,1971a, 1971b), 5.
                  <a href="../../post/stat/s1--%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E7%9A%84%E6%96%B9%E6%B3%95/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s3--%E5%8A%A0%E6%80%A7%E6%A8%A1%E5%9E%8B-additive-model/">
                <h2 class="post-title">S3--加性模型-additive-model</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<p>A.F. Zuur et al., <em>Mixed Effects Models and Extensions in Ecology with R</em>, p36, chr 3.2</p>
</blockquote>

<p>当线性模型的种种条件不能满足时，就要考虑用平滑性模型来替代。平滑性模型可以对非线性关系建模，也被称之作<strong>加性模型</strong>。加性模型是一般加性模型（<strong>GAM</strong>）的一类，是具有高斯分布的一般加性模型。
*<strong>Y_i* = *α* + *β* × *X_i* + *ε_i</strong>*</p>

<p>线性模型中最重要的是参数<strong>β</strong>，加性模型中是利用一个平滑函数将<strong>Yi </strong>和<strong>Xi </strong>连接起来。即：
 ​<strong>Y_i* = *α* + *f* (<em>X_i</em>) + *ε_i</strong>
​用平滑曲线*<strong>f *(*X</strong>i*)<strong>替代了线性模型中的</strong>*β × Xi ***。</p>

<p>线性模型​给了我们一个方程Y和X之间的关系用参数<strong><em>β </em></strong>量化。<strong>GAM</strong>中没有这样的方程，只有一个平滑函数，唯一能做的是把它画出来。这不是说不能用于预测了，同样可以，只是没了方程而已。置信区间变成了置信带。
<img src="http://upload-images.jianshu.io/upload_images/3289684-309f9b612c52f319?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s4--%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/">
                <h2 class="post-title">S4--线性回归模型</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  

<blockquote>
<p>A.F. Zuur et al., <em>Mixed Effects Models and Extensions in Ecology with R</em>, p17-25, chr 2.2-2.3</p>
</blockquote>

<h1 id="1-模型">1.模型</h1>

<p>*<strong>Y_i* = *α* + *β* × *X_i* + *ε_i</strong>**</p>

<p><strong><em>ε_i</em></strong>包含不能解释的信息，并且*ε_i *∼ <em>N</em>(0*,σ^*2)。
用样本估计​***α <strong><em>和</em></strong>β*<strong>的置信区间，</strong>置信区间<strong>告诉我们如果重复实验很多次，​</strong>*α <strong><em>和</em></strong>β<strong><em> 的真值落入该区间的可能性。
估计参数​</em></strong>α <strong><em>和</em></strong>β*<strong>需要假设：</strong>正态、同质性<strong>，固定的X，</strong>独立性**及特定而正确的模型。
正态是指对任何X，对应的Y们服从正态分布。同质性是指对于全部的X，对应的Y的高斯密度曲线们都是一样的（下图）。
<img src="http://upload-images.jianshu.io/upload_images/3289684-afa72cf8bc2ee55d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<h1 id="2-模型验证">2.模型验证</h1>

<p><strong>模型验证</strong>过程，就是验证一系列的假设。
因中心极限定理的缘故，有人说正态性的验证不是一个严重的问题(Sokal andRohlf, 1995; Zar, 1999)。甚至有人说如果样本量够大，正态验证不是必要的(Fitzmaurice et al., 2004)。
对于每个X值处的<strong>正态验证</strong>，需要对X值处Y值们做直方图。但通常每个X那里没有足够的Y，在这种情况下，最好的做法是把全部的残差混起来做一个直方图。这样做保证了残差的正态性，但我们并不能因此得出整个群体的Y是服从正态分布的。很多时候我们对Y画一个直方图来判断其正态与否，但这是有前提的：在每一个X处都有重复的观测值。否则不能单单根据观测值的直方图来判定其正态性，而是应该<strong>利用一个模型，检查残差的分布情况</strong>。
​<strong>同质性</strong>是要求在每一个X值处，观测值有相同的分散程度。这样判断有点主观，Barlett’s test是客观的方法，但软件要求数据要正态分布，这是有问题的，而且​​​​​Barlett’s test对非正态数据的同质性非常敏感，所以只靠图检残差分布是否一致是更好的选择。严重的异质性是非常要命的。转换数据可以部分解决，但缺点是会改变之间的关系。
<strong>独立性</strong>的验证是最重要的，因为它能使一些重要的检验如<em>F</em>-test和<em>t</em>-test无效。不独立是指X处的Y值受到另一个X变量的影响​。
在相信获得的<em>F</em>-statistic​并利用5%拒绝水平前，需要确信所有的模型假设都是有效的。标准的模型验证图有<strong>（1）残差vs拟合值验证同质性，（2）QQ或直方图验证正态性，（3）残差vs每个自变量检验独立性</strong>。
<img src="http://upload-images.jianshu.io/upload_images/3289684-2fb1816bb8bbe1da?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s5--%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1ml%E5%92%8Creml/">
                <h2 class="post-title">S5--最大似然估计（ML）和REML</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<p>A.F. Zuur et al., <em>Mixed Effects Models and Extensions in Ecology with R</em>, p116-119, chr 5.6</p>
</blockquote>

<p>当利用混合效应建模时，你会遇到诸如<strong>REML</strong>和<strong>ML</strong>这样的词汇。不像线性回归模型，就算你不知道背后的数学理论也可以照样使用。但是在混合效应建模中，你必须懂得一些相关的数学知识。所以REML是什么意思？它能干什么？
第一个问题比较简单，REML限制性最大似然估计英文首字母的缩写。但是对于第二个问题，大多数教材在这点上就变得相当专业，或者解释得比较粗略，只是提到它是矫正自由度的一个神秘方法。而我们则选择尝试更为详细地解释它，所以需要利用矩阵代数的知识。但是为了理解REML，首先需要理解最大似然估计的原理，我们从这儿开始。如果你不熟悉矩阵代数，或者如果这一部分对数学水平的要求太高，我们仍建议你跳过这一部分。
我们首先回顾用于线性回归的最大似然，然后给出REML是如何用于矫正方差估计子的。
假设有一个线性回归模型<img src="http://upload-images.jianshu.io/upload_images/3289684-0db7e3ae6226351d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
模型中有3个未知参数α, β, and σ。为了简便，θ = (α, β, σ ) 。普通最小二乘是估计θ的一个方法。给出θ中每一个元素的表达式。利用线性回归获取方差估计的表达式是：
<img src="http://upload-images.jianshu.io/upload_images/3289684-d9edcfc5add18482.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /><strong>（5.14）</strong>
我们给参数加了一个帽子^，表示它是估计值，n是观测值的个数。可以证明σ^是σ的无偏估计，意味着E（σ^）=σ。现在让我们看一看最大似然估计方法。假设Y_i服从正态分布，其密度函数为
<img src="http://upload-images.jianshu.io/upload_images/3289684-4c2a5bb931bedfb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
因为我们也假设了Y_i是独立的，可以将Y1,Y2,&hellip;,Yn的联合密度函数写成单个密度曲线f1,f2,&hellip;,fn乘积的形式。这个乘积就叫做<strong>似然函数*L</strong>*。它是数据和θ的一个函数。问题是如何选择θ使L最高。为了简化，对L取自然对数，得到如下的log-似然方程式：</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-9563527fc24fa83f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
我们需要最大化这个式子，问题就变成了对每一个参数偏导，令偏导数=0并求解。因为我们很容易计算，这些偏导数=0的式子称之为<strong>封闭解</strong>。对于线性混合模型我们将会看到<strong>开放解</strong>，意思是参数没有直接的解。
这里没有给出α和β估计子的式子，但对于方差我们得到：
<img src="http://upload-images.jianshu.io/upload_images/3289684-61cabd3ef71b1ba5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
注意这个式子与我们利用普通最小二乘得到的式子（5.14）非常相似。实际上，受到因子（n-2）/n的影响，利用最大似然得到的方差估计子是有偏的（<a href="http://www.jianshu.com/p/66c643f89f32">S6. 回归分析为什么误差方差中自由度是n-2？</a>）。如果线性回归模型含有*p*个解释变量，那么偏度是（n-p）/n。<strong>最大似然是有偏的的原因是它忽略了截距和斜率也被估计的事实。所以我们需要更好的ML估计子，而这正是REML所做的事情</strong>。
REML的工作如下：线性回归模型<img src="http://upload-images.jianshu.io/upload_images/3289684-0db7e3ae6226351d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />可以写成
<img src="http://upload-images.jianshu.io/upload_images/3289684-b1604dff3a0237be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />，这是简单的矩阵形式，Xi=（1 Xi），β的第一个元素是截距，第二个元素是原始的β。正态性假设意味着
<img src="http://upload-images.jianshu.io/upload_images/3289684-6c04857f17d78adc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /><strong>（5.18）</strong>。
用ML估计子的问题是我们不得不估计式子（5.18）中β中的截距和斜率。显然，如果没有β，就能解决问题。为了消除β，可以找到一个维度n × (n – 2) 的特殊矩阵<strong>A</strong>，特殊指的是“与<strong>X&rsquo;</strong>正交”，然后用这个矩阵乘以<strong>Y</strong>=（*Y1*，&hellip;，*Yn*）&rsquo;之后再用ML估计。正交指的是如果A与X相乘，结果是0.因此，我们得到A&rsquo;×Y=A&rsquo;×X×β+A&rsquo;×ε =0+A&rsquo;×ε =A&rsquo;×ε 。现在A&rsquo;×Y的分布是
<img src="http://upload-images.jianshu.io/upload_images/3289684-a9d2b5af1f90993a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />，而不再依赖β。那么对A&rsquo;×Y进行似然估计就会得到σ 2的无偏估计子（5.14）。现在我们讨论REML如何应用到混合线性模型。我们的起点是边际模型
<img src="http://upload-images.jianshu.io/upload_images/3289684-2b54a43157f60659.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />。故事又重新开始，如之前，我们可以写一个略微不同的log似然式子。未知参数是β和D及Σ中的元素，依然用θ 表示。似然函数：
<img src="http://upload-images.jianshu.io/upload_images/3289684-da4a52b1a18d6f0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
|Vi| 是Vi的行列式。对β求偏导并=0解方程。如之前讨论的例子，得到的参数是有偏的，因此我们需要REML。
总之，<strong>REML，就是用一个特殊的矩阵乘以Y，这样X×β就消去。然后用ML估计得到的参数估计子就是无偏的，并且与特定的矩阵相乘无关</strong>。因此，β的REML估计子与ML的估计子不同。<strong>如果相对于观测值的个数，固定协变量的个数很少，就没有太大的不同，相反有许多的固定协变量，情况就大不相同。</strong></p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s6--%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%AF%E5%B7%AE%E6%96%B9%E5%B7%AE%E4%B8%AD%E8%87%AA%E7%94%B1%E5%BA%A6%E6%98%AFn-2/">
                <h2 class="post-title">S6--回归分析为什么误差方差中自由度是n-2？</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<ol>
<li>Crawley MJ. Statistics: An Introduction Using R [Internet]. 2nd ed. Wiley; 2014. Available from: <a href="http://gen.lib.rus.ec/book/index.php?md5=7039b0c2dae409ebbd1cc9bdb44c10bd">http://gen.lib.rus.ec/book/index.php?md5=7039b0c2dae409ebbd1cc9bdb44c10bd</a> p118
<img src="http://upload-images.jianshu.io/upload_images/3289684-d9edcfc5add18482.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></li>
</ol>
</blockquote>

<p>当响应变量和解释变量都是连续变量时，我们通常使用的统计方法是回归分析。当想知道适不适合用回归分析时，最简单的方法是做散点图，对于方差分析则做箱线图或是条形图。
回归分析的本质是利用样本数据估计参数值和它们的标准误。但是首先我们需要选择一个能够描述解释变量和响应变量间关系的模型。我们能选的模型有数百个。也许学习回归最重要的事情是模型选择。最简单的模型是线性回归y=a+bx。模型中有2个参数，a和b，a是截距b是斜率。b很重要，有必要弄清楚它涉及的内容。y的变化除以x的变化。
估计出2个参数以后，我们还想知道它们的可靠性或不可靠性。我们最想要的是参数的最大似然估计，就是说，给定数据，选择一个线性模型，我们想找出使数据出现可能性最大的参数。
<strong>回归斜率b的最小二乘估计</strong>：最佳拟合斜率是通过旋转直线直至找出残差平方和最小。
<strong>自由度的估计</strong>：我们应当知道与每个均方和相应的自由度。最容易处理的是得到总均方和的，因为它的自由度总是有相同的公式。定义是
<img src="http://upload-images.jianshu.io/upload_images/3289684-74da605e63a98e9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
，你可以发现只有一个从数据中估计的参数——均值ybar。因为我们已经从数据中估计了一个参数，所以我们有n-1个自由度（n是观测值的总个数）。第二个比较容易得到的是误差均方和的自由度。 让我们看一下它的式子有多少个参数需要估计
<img src="http://upload-images.jianshu.io/upload_images/3289684-3d873bdac6b6fb85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />。我们需要知道a和b2个的数值才能计算SSE。它们是从数据中估计的，所以误差的自由度是n-2.这一点很重要，所以重读最后一句话如果你还没有看见它。3个中最困难的是回归的自由度，因为你需要用一个不同的方式去思考。问题是：在y的均值之外有多少个额外的参数？答案是1。那个额外要估计的参数是斜率b。所以这个只有一个解释变量的简单模型中，回归的自由度是1。</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../post/stat/s7--%E6%A8%A1%E5%9E%8B%E9%80%89%E6%8B%A9/">
                <h2 class="post-title">S7--模型选择</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<ol>
<li>Crawley MJ. Statistics: An Introduction Using R [Internet]. 2nd ed. Wiley; 2014. Available from: <a href="http://gen.lib.rus.ec/book/index.php?md5=7039b0c2dae409ebbd1cc9bdb44c10bd">http://gen.lib.rus.ec/book/index.php?md5=7039b0c2dae409ebbd1cc9bdb44c10bd</a> p120</li>
</ol>
</blockquote>

<p>模型选择有2个主要的方法：
1. 基于选择工具比如<strong>AIC或BIC</strong>。AIC 和BIC 都包含2项，测定模型拟合和模型的复杂度。似然值用于定义拟合测定；参数的个数测定复杂度。log似然函数可以用于测定拟合，但是有2个似然函数，REML 和ML
<img src="http://upload-images.jianshu.io/upload_images/3289684-3d12446be9b7c922.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
<img src="http://upload-images.jianshu.io/upload_images/3289684-4b9f58c01183534c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />。
AIC和BIC的区别是，后者考虑了观测值的个数。对于ML，n<em>=n，对于RMEL，n</em>=n-p。这就意味着基于REML的AIC（BIC）和基于ML的AIC（BIC）是不可比的。
2. <strong>假设检验</strong>。3中方法，t-统计量、F-统计量或似然比检验。
<strong>模型选择的策略</strong>：从上至下。</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
        </div>
        
          <ul class="pager main-pager">
            
            
              <li class="next">
                <a href="../../tags/stat/page/2/">Older Posts &rarr;</a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:dongleiming2008@126.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/username" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/username" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/username" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://telegram.me/username" title="Telegram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-telegram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="../../tags/stat/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Leiming Dong
            
          

          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="../../">Dong&#39;s blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.31.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../js/main.js"></script>
<script src="../../js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="../../js/load-photoswipe.js"></script>






  </body>
</html>

