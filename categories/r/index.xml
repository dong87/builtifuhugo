<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R on Dong&#39;s blog</title>
    <link>/categories/r/</link>
    <description>Recent content in R on Dong&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <managingEditor>youremail@domain.com (Leiming Dong)</managingEditor>
    <webMaster>youremail@domain.com (Leiming Dong)</webMaster>
    <lastBuildDate>Sun, 01 Oct 2017 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="/categories/r/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>如何计算效应值（例如育种值）的准确性（accuracy）？</title>
      <link>/post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/</link>
      <pubDate>Sun, 01 Oct 2017 00:00:00 +0000</pubDate>
      <author>youremail@domain.com (Leiming Dong)</author>
      <guid>/post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/</guid>
      <description>准确性指的是预测效应值与真值之间的相关系数。有时还会遇见一个概念——可靠性（reliability）。可靠性是准确性的平方，也就是说这二者度量的是一个事情。reliability其实就是遗传力，这句很重要！！！。遗传力主要用来计算选择响应（response to selection）。advisor说我的文章短句子太多，不连贯，确实是这样LOL。 准确性的计算公式为：
$$r=\sqrt{1-\frac{PEV}{\hat{\sigma}_a^2}}$$
*PEV*是prediction error variances的缩写，意思是预测误差方差，预测误差是预测值与真值间的差，即：
$$PEV=var(\hat g-g)=(1-r_{\hat g,g}^2)\sigma_a^2$$
$\sigma_a^2$是加性方差。
预测差值的标准误（*SED*）是可以从Asreml中直接得到的，与*PEV*的关系是：
$$ SED=\sqrt{\hat Var(BLUP.differences)}=\sqrt{\hat Var(\hat Yi-\hat Y{i^`})}=\sqrt{2\hat Var(\hat Y)_i}=\sqrt{2PEV} $$
我不知道上面这个公式怎么推导的。 所以有
$$PEV=(SED)^2 /2=\hat Var(BLUP.differences)/2$$
在很长时间里我不知道（或者说模糊地知道）accuracy是怎么实现的。我知道公式，但在软件里分别和公式组分对应的部分是什么却不是很清楚，当然写这篇文字的时候是确定的。具体实现的途径有2：
 一是利用Asreml中的prediction直接得到*SED*后，再根据公式4得出PEV
fm_pred &amp;lt;- predict(fm_asr, classify = &amp;quot;Fam&amp;quot;) #fm_asr是asreml()输出的对象， Fam是随机效应变量 SED &amp;lt;- fm_pred$predictions$avsed  二是逐步得到*PEV*，每个预测值都有一个*PEV*，是预测值*SE*平方的均值，所以从预测函数得到的对象中提取出*SE*平方后再平均即可
fm_pred &amp;lt;- predict(fm_asr, classify = &amp;quot;Fam&amp;quot;, present = &amp;quot;Plot&amp;quot;) #注意！这里预测的时候是要矫正掉其他的随机效应（如Plot） SE &amp;lt;- fm_pred$predictions$pvals$standard.error PEV &amp;lt;- SE^2 %&amp;gt;% mean  这里的*PEV*是一个向量，对应到每个水平上。 所以，总体上，*PEV*、*SED*和*SE*的关系是 $$PEV=(SED)^2&amp;frasl;2=ave(SE_i^2)$$
  另外，在林元震老师的著作R与ASReml-R统计学中（P474）也涉及到accuracy的代码
SE &amp;lt;- fm_asr$vcoeff$random * fm_asr$sigma2 #效应值se乘以sigma  结果是一样的，但不知道是否合理。</description>
    </item>
    
    <item>
      <title>Hello R Markdown</title>
      <link>/post/2015-07-23-r-rmarkdown/</link>
      <pubDate>Thu, 23 Jul 2015 21:13:14 -0500</pubDate>
      <author>youremail@domain.com (Leiming Dong)</author>
      <guid>/post/2015-07-23-r-rmarkdown/</guid>
      <description>R MarkdownThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.
You can embed an R code chunk like this:
summary(cars)## speed dist ## Min. : 4.0 Min. : 2.00 ## 1st Qu.:12.0 1st Qu.: 26.00 ## Median :15.0 Median : 36.00 ## Mean :15.4 Mean : 42.98 ## 3rd Qu.</description>
    </item>
    
  </channel>
</rss>