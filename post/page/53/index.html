<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Posts</title>
  <meta property="og:title" content="Posts" />
  <meta name="twitter:title" content="Posts" />
  <meta name="author" content="Leiming Dong"/>
  <link href='../../../img/red-paint.jpg' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="/img/red-paint.jpg" />
  <meta name="twitter:image" content="/img/red-paint.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@username" />
  <meta name="twitter:creator" content="@username" />
  <meta property="og:url" content="/post/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Dong&#39;s blog" />

  <meta name="generator" content="Hugo 0.31.1" />
  <link rel="canonical" href="../../../post/" />
  <link rel="alternate" href="../../../post/index.xml" type="application/rss+xml" title="Dong&#39;s blog">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="../../../css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="../../../css/codeblock.css" />
  <link rel="stylesheet" href="../../../css/highlight.min.css" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../">Dong&#39;s blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="../../../">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Samples</a>
              <div class="navlinks-children">
                
                  <a href="../../../post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="../../../post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="../../../post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="../../../page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="../../../tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Dong&#39;s blog" href="../../../">
            <img class="avatar-img" src="../../../img/red-paint.jpg" alt="Dong&#39;s blog" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  <header class="header-section ">
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>Posts</h1>
              <hr class="small">
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

    
  <div class="container" role="main">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <div class="posts-list">
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E6%BC%94%E5%8C%96%E7%A5%9E%E5%88%9B%E4%B8%8Erichard-dawkins/">
                <h2 class="post-title">演化、神创与Richard-Dawkins</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <p>先挖坑，谈谈自己对演化与神创的认识，另外一个目的是写一点Richard Dawkins著作的读后感，可能会持续很长时间。</p>

<hr />

<p>这里不考究相关的概念和理论，有很多想当然的成分。
演化最著名的著作非达尔文的《物种起源》莫属。这本书令人神往，又被许多老师推荐。本科期间曾找来阅读，中文英文中英文对照版本都有，但没能坚持读完。内容有点枯燥，而且主要是放在一个大生物的背景下，与我所涉及的林业有点远，这是题外话。
神创论是许多人的精神食粮。我们在解决一顿饭食后容易思考一些关于人的终极问题，如人是怎么来的以及我们的存在有何意义，只有圣经给出了解释，当然佛也做出了一定的分析但佛不是神创论。在一段时期内我倾向于神创论，因为相比之下我更难以接受人和类人猿甚至猴子有共同的祖先。有人说现在国内的基督教是新教的分枝（知乎某牛）
我私认为，演化在很大程度上动摇了神创论的根基，而且越来越多的证据在支持演化，相反神创论并没有太多的实例。尽管神迹不断被宣扬，不断被解释，但这中间掺杂多少人的想法不得而知，可以明确的一点是，偏客观的神迹在圣经编写完成以后就几乎不见了。</p>

<p>Richard Dawkins的著作：
- <a href="https://www.amazon.com/God-Delusion-Richard-Dawkins/dp/0618918248/ref=la_B000AQ3RBI_1_1?s=books&amp;ie=UTF8&amp;qid=1494811261&amp;sr=1-1">The God Delusion
</a>Jan 16, 2008</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-9ae976a385fb0a64.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<ul>
<li><a href="https://www.amazon.com/Selfish-Gene-Anniversary-Landmark-Science/dp/0198788606/ref=la_B000AQ3RBI_1_2?s=books&amp;ie=UTF8&amp;qid=1494833716&amp;sr=1-2">The Selfish Gene: 40th Anniversary Edition (Oxford Landmark Science)
</a>Aug 1, 2016</li>
</ul>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-2aa526f78cc1e3c4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
- <a href="https://www.amazon.com/Blind-Watchmaker-Evidence-Evolution-Universe/dp/0393315703/ref=la_B000AQ3RBI_1_9?s=books&amp;ie=UTF8&amp;qid=1494833807&amp;sr=1-9">The Blind Watchmaker: Why the Evidence of Evolution Reveals a Universe without Design (Reissued in 2006 and 1996)
</a>Sep 17, 1996</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-6d967f4571b06377.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
- <a href="https://www.amazon.com/Greatest-Show-Earth-Evidence-Evolution/dp/1416594795/ref=la_B000AQ3RBI_1_4?s=books&amp;ie=UTF8&amp;qid=1494833807&amp;sr=1-4">The Greatest Show on Earth: The Evidence for Evolution
</a>Aug 24, 2010</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-8b34710f80b93e35.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/rcodes/%E7%9B%B8%E5%85%B3/">
                <h2 class="post-title">相关</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <pre><code># corr
heterosis&lt;-read.csv(&quot;heterosis_growth.csv&quot;,stringsAsFactors = FALSE)
names(heterosis)
# plot(heterosis$Midd05~heterosis$GD)
# plot(df.4$SCA_H05~df.4$GD)
hete&lt;-as.matrix(heterosis[,-1])
library(Hmisc) #相关显著性检验
a&lt;-rcorr(hete, type=&quot;pearson&quot;) 
# a&lt;-cor(hete,method = c(&quot;pearson&quot;), use = &quot;complete.obs&quot;)
write.csv(a$r,&quot;corr_hete_gd.csv&quot;)
write.csv(a$P,&quot;corr_hete_gd_pvalue.csv&quot;)
</code></pre>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/rcodes/">Rcodes</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%9B%B8%E5%85%B3%E5%88%86%E6%9E%90-correlation-analysis-in-r-#rstat%23/">
                <h2 class="post-title">相关分析-correlation-analysis-in-r-#rstat#</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<p>皮尔森相关分析是最常用的一种适用于连续性变量的相关分析方法，在所有的具有统计分析功能的软件中都能处理。在<code>R</code>中处理不仅简便，利用<code>rmarkdown</code>还能以<code>word</code>的形式呈现结果。底层函数能够同时计算变量矩阵中变量间的相关系数（<code>cor</code>），但假设检验只能一对一对的进行（<code>cor.test</code>），而借助包<code>psych</code>中的<code>core.test</code>函数则能同时报告相关系数及相应的p-value。</p>
</blockquote>

<ol>
<li>加载用到的包
<code>
library(tidyverse)
library(psych)
</code></li>
<li>数据导入
<code>
options(digits = 3)
df &lt;- read.csv(&quot;input/corr.csv&quot;) %&gt;% .[, c(3:9)]
results &lt;- corr.test(df)
</code></li>
<li>相关系数
<code>{r echo=FALSE}
knitr::kable(results$r, caption = &quot;表1 相关系数 Correlation matrix&quot;)
</code></li>
<li>p-value
<code>{r echo=FALSE}
knitr::kable(results$p, caption = &quot;表2 相关系数的p值 Probability values (Entries above the diagonal are adjusted for multiple tests.)&quot;)
</code></li>
</ol>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%9B%B8%E5%85%B3%E5%9B%BE/">
                <h2 class="post-title">相关图</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  今天学习文献（Pagliarini2016），看到这样的相关系数图： 以往通常用表的形式： 或者用矩阵图的形式： 像Pagliarini2016中的热图头一次见于文献（有点炫，适合PPT用）。那怎么实现的呢？corrplot可以做这个事：
## 构建相关矩阵 M&lt;-cor(mtcars) ## 热图 corrplot(corr, method=&quot;circle&quot;)  因为上对角和下对角是一样的，也可以只有一半：
corrplot(M, type=&quot;upper&quot;)  但是这些热图有个问题是，不知道显著性。corrplot也可以实现： 1. 获得显著性矩阵
# mat : is a matrix of data # ... : further arguments to pass to the native R cor.test function cor.mtest &lt;- function(mat, ...) { mat &lt;- as.matrix(mat) n &lt;- ncol(mat) p.mat&lt;- matrix(NA, n, n) diag(p.mat) &lt;- 0 for (i in 1:(n - 1)) { for (j in (i + 1):n) { tmp &lt;- cor.
                  <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%9B%B8%E5%85%B3%E5%9B%BE/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/stat/%E7%A9%BA%E9%97%B4%E8%87%AA%E7%9B%B8%E5%85%B3/">
                <h2 class="post-title">空间自相关</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  https://github.com/famuvie/breedR/wiki/Overview#hierarchical-and-factorial-models
 概念 环境因素影响响应值，造成距离更近的个体之间比距离远的个体间更相似。它会影响估计值和估计精度。这是试验要随机到空间区组中去的原因。
残差图 空间自相关的诊断（残差变异函数variograms of residuals）  Isotropic variogram： 不考虑方向The empirical isotropic variogram is built by aggregating all the pairs of points separated by (h),no matter the direction.  - Row/Column variogram: 行列The empirical row/col variogram is built by aggregating all the pairs of points separated by exactly (x) rows and (y) columns.
 Anisotropic variogram:方向相同 The empirical anisotropic variogram is built by aggregating all the pairs of points in the same direction separated by x.
                  <a href="../../../post/stat/%E7%A9%BA%E9%97%B4%E8%87%AA%E7%9B%B8%E5%85%B3/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/stat/">stat</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%B3%BB%E8%B0%B1%E6%9E%84%E5%BB%BA%E4%B8%AD%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%92%8Csnp%E7%9A%84%E7%89%B9%E7%82%B9/">
                <h2 class="post-title">系谱构建中微卫星和SNP的特点</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  Pemberton J . 2008. Wild pedigrees: the way forward. Proceedings of the Royal Society B: Biological Sciences, 275(1635): 613–621.
  SSR 微卫星是多年来推断亲缘关系常用的标记（Parker et al。1998; Jones＆Ardren 2003）。它具有其他标记类型不具备的特点：单座位信息，共显性，由于低频下的许多等位基因导致的高变异性，通过自动化的高通量潜力和适于对从野生种群获得的法医样品的分析的短DNA片段。识别新物种的微卫星标记是通过从头发现或利用其跨物种效用。现在通常获得用于亲本分析的基因型只是时间和金钱的问题。 【缺点】有时，微卫星很难找到或者多态性差。基因分型易于发生突变（分型错误），且有明显比例的基因座具有分离无效等位基因（Dakin＆Avise 2004），所有这些都可能引起假亲本排除。影响长期研究的技术问题是微卫星等位基因大小在检测平台之间变化。
 SNP 未来，单核苷酸多态性（SNPs）可能常用于自然种群的谱系重建。 虽然与微型卫星相比信息量少得多，但它们存在大量数据，并且与微型卫星相比潜在的误差更小。 因此，识别个体和亲本的能力可能非常高（Anderson＆Garza 2006）。 目前已经为动物和人类开发了单核苷酸多态性的panel，并且研究证实了它们与标准微卫星相比的有用性（例如Phillips等人2007; Rohrer等人2007）。
   Berger-Wolf T Y, Sheikh S I, DasGupta B, et al. 2007. Reconstructing sibling relationships in wild populations. Bioinformatics, 23(13).
 与显性标记如AFLP和ISSR不同，微卫星等位基因是共显性的，因此每个基因座的基因型和等位基因频率的推断是直接的。 对于不受大规模基因组计划影响的物种，SNPs的开发比微卫星开发更加困难和昂贵。 更重要的是，识别相关个体的能力主要取决于每个基因座的等位基因数及其杂合度，微卫星在两个方面明显优于其他标记，5-20等位基因和杂合度&gt; 0.700是典型的，如 许多野生种群。
 Trong T Q, van Bers N, Crooijmans R, et al.
                  <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%B3%BB%E8%B0%B1%E6%9E%84%E5%BB%BA%E4%B8%AD%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%92%8Csnp%E7%9A%84%E7%89%B9%E7%82%B9/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%BA%B8%E7%89%8C%E5%B1%8B-%E8%8B%B1%E6%96%87%E5%AD%97%E5%B9%95-%E5%89%A7%E6%9C%AC-s1-s5-txt-%E4%B8%8B%E8%BD%BD/">
                <h2 class="post-title">纸牌屋-英文字幕-剧本-S1-S5-txt-下载</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <blockquote>
<p><a href="https://zh.wikipedia.org/zh-cn/%E7%BA%B8%E7%89%8C%E5%B1%8B">纸牌屋</a>是部好剧，是很好的英文学习素材。网上只能找到<a href="http://www.zimuzu.tv/">字幕</a>，但并没有现成的纯文本可供下载，因此从字幕文件中抓取出来，并在这里分享。希望对你有用。</p>
</blockquote>

<p>度盘<a href="http://pan.baidu.com/s/1hsiQawc">下载链接</a> 密码: gwf9</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E7%BA%BF%E6%80%A7%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8Blmm/">
                <h2 class="post-title">线性混合模型LMM</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  

<h2 id="线性混合模型基础">线性混合模型基础</h2>

<p><strong>线性混合模型（LMM）</strong>是遗传评估中必用的统计模型，用以将群体中每个个体的观测值按照潜在影响因素进行分解。决定观测值的大小和幅度受2个参数（均值和方差）控制，反过来说也可以。一般我们更关注方差，围绕方差的运算与处理也更为复杂，所以能够将LMM中涉及的方差们的关系搞明白，就大体能理解这些没什么亲和力的模型们了。通常在介绍这一部分内容时，很容易让人发蒙，因为太抽象了，全是符号，所以前提是必须对数学这门外语有一定了解，就是一门外语啊。比如告诉我一个矩阵的维度是4×5，我头脑里有概念，这是小学的数学知识学得好，但你告诉我它的维度是n×p，我的CPU和GPU就不太够用了，所以得像学习英语一样，方法+重复才是硬道理。</p>

<p>如果知道了这些方差们的具体数值，求算各个因素的系数（我们最终要的是这个）就相对容易多了。但这些方差是怎么计算的？一般会告诉采用了什么方法（REML用的多），但这又是什么我想很多人想知道但没人教，所以一直糊涂着，只停留在会用的地步，当然会处理数据也够用。我很有兴趣，但到今天我也不全会，也没有能力在<code>R</code>中实现，原因是没那个功底，不会矩阵求导，盼望有一天谁来引领一下，但这不是刚需，因此参数求解就停在这里了。下面就我了解的知识对LMM做2部分的介绍，主要目的是自我梳理，学识有限，错误难免。</p>

<h3 id="1-lmm的形式">1. LMM的形式</h3>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-137c6954d8975b8f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
这是基本形式，更复杂的都是在其基础上演变出来的。</p>

<p>式子里一共有6个字母，4个小写，2个大写。小写是向量（1维矩阵），大写是矩阵。这几个字母的意思分别是：</p>

<table>
<thead>
<tr>
<th align="left">字母</th>
<th>名称</th>
<th>维度</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">y</td>
<td>观测值</td>
<td>n×1</td>
</tr>

<tr>
<td align="left">b</td>
<td>固定效应（p个水平）</td>
<td>p×1</td>
</tr>

<tr>
<td align="left">a</td>
<td>随机效应（q个水平）</td>
<td>q×1</td>
</tr>

<tr>
<td align="left">e</td>
<td>随机残差</td>
<td>n×1</td>
</tr>

<tr>
<td align="left">X</td>
<td>固定效应设计矩阵</td>
<td>n×p</td>
</tr>

<tr>
<td align="left">Z</td>
<td>随机效应设计矩阵</td>
<td>n×q</td>
</tr>
</tbody>
</table>

<p>有几个假设</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-abc2692b7c726f04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<p>意思是a和e这2个向量的参数（均值和方差），均值都是0，方差分别是G和R，协方差是0（彼此独立，没有线性关系）。G和R具体又是什么？
<img src="http://upload-images.jianshu.io/upload_images/3289684-f1d006b08e18fa41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />，
<img src="http://upload-images.jianshu.io/upload_images/3289684-72ceccb21c11e509.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />。*A*是随机效应中q个水平之间的关系矩阵（分子关系矩阵），如果水平间不相关（独立），那么就等同于单位矩阵*I*。这里只假设a是1个效应，a也可以是含有多个效应的列向量；同样，在某些情况下，也可以继续分解R。此外，观测值的期望是<strong>E(y)=Xb</strong>，方差（marginal）<strong>var(y)=V=ZGZ^T+R</strong>。期望比较容易理解，方差为何是这个形式？G左右为何乘以Z？很多材料没有给详细的推导式子。Mrode（2013，p35）中：</p>

<p><img src="http://upload-images.jianshu.io/upload_images/3289684-9fa74adafa220543.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<p>总之，一个普通LMM中的元素就这么多，了解了这些内容，才有可能看懂后续的似然函数以及参数具体的ML或REML过程。</p>

<h3 id="2-reml过程-待更">2. REML过程（待更）</h3>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E6%8A%95%E7%A8%BF%E6%8A%80%E5%B7%A7/%E8%87%B4%E8%B0%A2/">
                <h2 class="post-title">致谢</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  I am grateful to two anonymous referees for useful comments on an earlier version of this manuscript. We would like to thank Drs. Peter Clarke, Steen Magnussen, and John King for their stimulating discussion on the research; Dr. William Wingle for his excellent help in the data analyses with his UNCERT program; and Dr. Rowland Burdon for his constructive comments on the early version of the manuscript. This research is financially supported by Forest Renewal BC research grant No.
                  <a href="../../../post/%E6%8A%95%E7%A8%BF%E6%8A%80%E5%B7%A7/%E8%87%B4%E8%B0%A2/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E6%8A%95%E7%A8%BF%E6%8A%80%E5%B7%A7/">投稿技巧</a>&nbsp;
                  
                </span>
              

            </article>
          
            <article class="post-preview">
              <a href="../../../post/%E9%9A%8F%E7%AC%94/%E8%88%AC%E8%8B%A5%E6%B3%A2%E7%BD%97%E8%9C%9C%E5%A4%9A%E5%BF%83%E7%BB%8F/">
                <h2 class="post-title">般若波罗蜜多心经</h2>

                
              </a>

              <p class="post-meta">
                Posted on October 1, 2017
              </p>
              <div class="post-entry">
                
                  <p><img src="http://upload-images.jianshu.io/upload_images/3289684-938f93cfa96e2dba.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" />
观自在菩萨，行深般若波罗蜜多时，照见五蕴皆空，度一切苦厄。
舍利子，色不异空，空不异色，色即是空，空即是色，受想行识，亦复如是。
舍利子，是诸法空相，不生不灭，不垢不净，不增不减。
是故空中无色，无受想行识，无眼耳鼻舍身意，无色声香味触法。无眼界，乃至无意识界；无无明，亦无无明尽；乃至无老死，亦无老死尽。无苦集灭道，无智亦无得。以无所得故，菩提萨埵。依般若波罗蜜多故，心无挂碍，无挂碍故，无有恐惧。远离颠倒梦想，究竟涅槃。三世诸佛，依般若波罗蜜多故，得阿诺多罗三藐三菩提。故知般若波罗蜜多，是大神咒，是大明咒，是无上咒，是无等等咒，能除一切苦，真实不虚。故说般若波罗蜜多咒，即说咒曰：揭谛揭谛，波罗揭谛，波罗僧揭谛，菩提萨摩耶。</p>

<hr />

<p>观自在菩萨，行深般若波罗蜜多时，照见五蕴皆空，度一切苦厄。
舍利子，色不异空，空不异色，色即是空，空即是色。受想行识，亦复如是。
舍利子，是诸法空相，不生不灭，不垢不净，不增不减。
是故空中无色，无受想行识，无眼耳鼻舍身意，无色声香味触法。无眼界，乃至无意识界；无无明，亦无无明尽；乃至无老死，亦无老死尽。无苦集灭道，无智亦无得，以无所得故，菩提萨埵。依般若波罗蜜多故，心无挂碍，无挂碍故，无有恐惧。远离颠倒梦想，究竟涅槃。三世诸佛，依般若波罗蜜多故，得阿诺多罗三藐三菩提。故知般若波罗蜜多，是大神咒，是大明咒，是无上咒，是无等等咒。能除一切苦，真实不虚。故说般若波罗蜜多咒，即说咒曰：揭谛揭谛，波罗揭谛，波罗僧揭谛，菩提萨摩耶。</p>

<hr />

<p>观自在菩萨，行深般若波罗蜜多时，照见五蕴皆空，度一切苦厄。
舍利子，色不异空，空不异色，色即是空，空即是色，受想行识，亦复如是。
舍利子，是诸法空相，不生不灭，不垢不净，不增不减。
是故空中无色，无受想行识，无眼耳鼻舍身意，无色声香味触法。无眼界，乃至无意识界；无无明，亦无无明尽；乃至无老死，亦无老死尽。无苦集灭道，无智亦无得，以无所得故，菩提萨埵。依般若波罗蜜多故，心无挂碍，无挂碍故，无有恐惧。远离颠倒梦想，究竟涅槃。三世诸佛，依般若波罗蜜多故，得阿诺多罗三藐三菩提。故知般若波罗蜜多，是大神咒，是大明咒，是无上咒，是无等等咒。能除一切苦，真实不虚。故说般若波罗蜜多咒，即说咒曰：揭谛揭谛，波罗揭谛，波罗僧揭谛，菩提萨摩耶。</p>

<hr />

<p>觀自在菩薩，行深般若波羅蜜多時，照見五蘊皆空，度一切苦厄。
舍利子，色不異空，空不異色，色即是空，空即是色，受想行識，亦復如是。
舍利子，是諸法空相，不生不滅，不垢不淨，不增不減。
是故空中無色，無受想行識，無眼耳鼻舌身意，無色聲香味觸法。無眼界，乃至無意識界，無無明，亦無無明盡，乃至無老死，亦無老死盡。無恐集滅道，無智亦無得，以無所得故，菩提薩埵。依般若波羅蜜多故，心無掛礙，無掛礙故，無有恐懼。遠離顛倒夢想，究竟涅槃。三世諸佛，依般若波羅蜜多故，得阿諾多羅三藐三菩提。故知般若波羅蜜多，是大神咒，是大明咒，是無上咒，是無等等咒。能除一切苦，真實不虛。故說般若波羅蜜多咒，即說咒曰：揭諦揭諦，波羅揭諦，波羅僧揭諦，菩提薩摩耶。</p>

<hr />

<p>觀自在菩薩，行深般若波羅蜜多時，照見五蘊皆空，度一切苦厄。
舍利子，色不異空，空不異色，色即是空，空即是色，受想行識，亦復如是。
舍利子，是諸法空相，不生不滅，不垢不淨，不增不減。
是故空中無色，無受想行識，無眼耳鼻舌身意，無色聲香味觸法。無眼界，乃至無意識界，無無明，亦無無明盡，乃至無老死，亦無老死盡。無恐集滅道，無智亦無得，以無所得故，菩提薩埵。依般若波羅蜜多故，心無掛礙，無掛礙故，無有恐懼。遠離顛倒夢想，究竟涅槃。三世諸佛，依般若波羅蜜多故，得阿諾多羅三藐三菩提。故知般若波羅蜜多，是大神咒，是大明咒，是無上咒，是無等等咒，能除一切苦，真實不虛。故說般若波羅蜜多咒，即說咒曰：揭諦揭諦，波羅揭諦，波羅僧揭諦，菩提薩摩耶。</p>

<hr />

<p>觀自在菩薩，行深般若波羅蜜多時，照見五蘊皆空，度一切苦厄。
舍利子，色不異空，空不異色，色即是空，空即是色，受想行識，亦復如是。
舍利子，是諸法空相，不生不滅，不垢不淨，不增不減。
是故空中無色，無受想行識，無眼耳鼻舌身意，無色聲香味觸法。無眼界，乃至無意識界，無無明，亦無無明盡，乃至無老死，亦無老死盡。無恐集滅道，無智亦無得，以無所得故，菩提薩埵。依般若波羅蜜多故，心無掛礙，無掛礙故，無有恐懼。遠離顛倒夢想，究竟涅槃。三世諸佛，依般若波羅蜜多故，得阿諾多羅三藐三菩提。故知般若波羅蜜多，是大神咒，是大明咒，是無上咒，是無等等咒，能除一切苦，真實不虛。故說般若波羅蜜多咒，即說咒曰：揭諦揭諦，波羅揭諦，波羅僧揭諦，菩提薩摩耶。</p>

                
              </div>

              
                <span class="post-meta">
                  
                    #<a href="../../../tags/%E9%9A%8F%E7%AC%94/">随笔</a>&nbsp;
                  
                </span>
              

            </article>
          
        </div>
        
          <ul class="pager main-pager">
            
              <li class="previous">
                <a href="../../../post/page/52/">&larr; Newer Posts</a>
              </li>
            
            
              <li class="next">
                <a href="../../../post/page/54/">Older Posts &rarr;</a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:youremail@domain.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/username" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://plus.google.com/&#43;username" title="Google&#43;">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/username" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://gitlab.com/username" title="GitLab">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-gitlab fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/username" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://reddit.com/u/username" title="Reddit">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-reddit-alien fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/username" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.xing.com/profile/username" title="Xing">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-xing fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/XXXXXXX/username" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.snapchat.com/add/username" title="Snapchat">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-snapchat-ghost fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/username" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/user/username" title="Youtube">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://soundcloud.com/username" title="SoundCloud">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-soundcloud fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://open.spotify.com/user/username" title="Spotify">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-spotify fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://username.bandcamp.com/" title="Bandcamp">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-bandcamp fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://itch.io/profile/username" title="Itch.io">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-gamepad fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://vk.com/username" title="VK">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-vk fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://paypal.me/username" title="PayPal">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-paypal fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://telegram.me/username" title="Telegram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-telegram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="../../../post/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="yourwebsite.com">Leiming Dong</a>
            
          

          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="../../../">Dong&#39;s blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.31.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../../js/main.js"></script>
<script src="../../../js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="../../../js/load-photoswipe.js"></script>






  </body>
</html>

